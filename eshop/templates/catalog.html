{% extends "base.html" %}
{% load tags %}
{% load static %}

{% block content %}
<div id="catalog" class="container">
  <br>
  <br>
  <h1 class="text-center">Somorter item catalog</h1>
  <br>

  <form method="POST" action="{% url 'catalog' %}">
    <div class="container row catalog">
      <div class="col-md-3" id="catalog-filter">
        <h3>Filters</h3>
        <div class="form-group row">
          <label for="minPrice" class="col-sm-6 col-form-label">Min price</label>
          <div class="col-sm-6">
            <input type="number" class="form-control" id="minPrice" name="minPrice"  placeholder="1" {% if filters.minPrice %}value="{{ filters.minPrice }}"{% endif %}>
          </div>
        </div>
        <div class="form-group row">
          <label for="maxPrice" class="col-sm-6 col-form-label">Max price</label>
          <div class="col-sm-6">
            <input type="number" class="form-control" id="maxPrice"  name="maxPrice" placeholder="1000" {% if filters.maxPrice %}value="{{ filters.maxPrice }}"{% endif %}>
          </div>
        </div>
      </div>
      <div id="catalog-items" class="col-md-9">
        <div class="input-group" id="itemSearch">
          <input type="search" class="form-control rounded" placeholder="Search" name="search" aria-label="Search"
            aria-describedby="search-addon" {% if filters.search %}value="{{ filters.search }}"{% endif %}/>
          <button type="submit" class="btn btn-outline-primary">search</button>
        </div>
        <div id="items">
          {% for item in items %}
          <div class="card item" path="{{item.path}}">
            <div class="card-body">
              {% if item.itemimage_set.all|item_image %}
              <img class="card-img-top" src="{{ item.itemimage_set.all|item_image }}" alt="{{ item.title }}">
              {% else %}
              <img class="card-img-top" src="{% static 'img/item-placehloder.png' %}" alt="{{ item.title }}">
              {% endif %}
              <h5 class="card-title item-title">{{ item.title|item_title:filters.search|safe }}</h5>
              <p class="card-text">{{ item.price }}$</p>
              <a href="#" class="btn btn-primary btn-sm">View</a>
            </div>
          </div>
          {% endfor %}
        </div>
        <div class="form-group row">
          <label for="itemsPerPage" class="col-sm-6 col-form-label">Items / page</label>
          <div class="col-sm-6">
            <input type="number" class="form-control" id="itemsPerPage"  name="itemsPerPage" placeholder="20" {% if filters.itemsPerPage %}value="{{ filters.itemsPerPage }}"{% endif %}>
          </div>
        </div>
        <div class="form-group row">
          <label for="page" class="col-sm-6 col-form-label">Page</label>
          <div class="col-sm-6">
            <input type="number" class="form-control" id="page"  name="page" placeholder="0" {% if filters.page %}value="{{ filters.page }}"{% endif %}> / {{ page_count }}
          </div>
        </div>
      </div>
      <script>
        $(document).ready(function () {
          {% if search %}
          $("#itemSearch input").val("{{ search }}")
          {% endif %}
        });

      </script>
    </div>
  </form>
</div>

{% endblock %}